# 자율주행 드론 opencv 밑 yolo 사용 

> yolo란 무엇인가

- you only look once의 약자로 실시간 객체탐지가 가능.
- object detection을 위한 CNN 기반 물체인식 알고리즘

1. yolo는 단일 신경망 구조이다.
2. 단 yolo는 다른 모델들에 비해 정확도가 다소 떨어진다.
3. CNN이란 데이터의 특징을 추출하여 특징들의 패턴을 파악하는 구조입니다.
4. CNN은 보통 정보추출, 문장분류, 얼굴인식 등의 분야에서 널리 사용되고 있습니다.

> 구현 방식

1. 하나의 이미지 데이터를 입력하면 물체들을 찾아 bounding box와 가장 높은 확률의 클래스를 찾는다.
2.  각 그리드셀에서 물체의 확률과 IOU값을 비교해 가장 높은 확률을 가진 클래스를 검출해 해당 그리드셀의 클래스를 확정
3.  확정된 클래스의 확률이 일정한 값( threshold )이상의 그리드셀을 이용해 bounding box를 그린다.

> yolo를 실행시기 위한 딮러닝 프레임 워크 선택

- AI 딮러닝 프레임워크
- 딮러닝 프레임워크란 
인공신경망 알고리즘 CNN, RNN 등의 알고리즘을 이용하여 이미 검증된 수많은 라브러리와 사전학습이 
이미 완료된 알고리즘을 제공하여 손쉽게 개발할 수 있게 도와주는 프로그램
1. 텐서플로우(Tensorflow)
2. 케라스(Keras)
3. 토치(Torch)
- 하지만 영상처리에 특화되지 않았다.
- 영상처리 특화 딮러닝 프레임워크 3가지 후보군
1. darknet: YOLO 개발자가 만든 프레임워크. YOLO를 위해 특별히 제작되었다.
   - 장점 : 빠르다. GPU또는 CPU와 함께 사용가능
   - 단점 : 리눅스에서만 호환
2. darkflow: Darknet을 텐서플로우에 적용한것
   - 장점 : 빠르고 GPU 또는 CPU와 함께 사용 가능하고 리눅스, 윈도우, 맥에서 호환
   - 단점 : 설치 복잡
3. opencv:
   -   장점 : openCV외에 설치할 것이 없다
   -   단점 : CPU에서만 작동하기 때문에 비디오를 실시간으로 처리하는 데 속도가 빠르진 않다

> 이중 opencv 를 선택
   - 이유:  설치가 간단하고 주어진 컴퓨터 환경에 가장 적합하다 판단.

- OPencv를 사용 하기 위해서는 import cv2를 해야한다.
- 이미지를 읽기 위해서는 cv2.imread(사진이름,flag)
- cv를 통해 반환되는 것은 Numpy이다. 따라서 opencv로 프로그래밍을 하면 Numpy 배열을 다루어야 한다.
- Numpy로 반환된 값을 토대로 객체의 화면에서의 위치는 row col 값으로 받고 이를 토대로 경로를 설정 함.
참고: https://m.blog.naver.com/bosongmoon/221771634755

> 문제점
> 
opencv를 사용하니 이미지 처리속도가 느려 드론의 움직임을 따라 잡지 못함
 > 해결 방안

 CV2 "cv2.imread(imgFile, flag)"를 이용하여 이미지를 읽을때 flag 부분을 IMREAD_GRAYSCALE로 변경하여 실험 -> 성능이 약 20% 증가

- 1 : IMREAD_COLOR : color(BGR)로 읽기, defult값, flag를 생략하면 자동으로 1로 인식
- 0 : IMREAD_GRAYSCALE : gray-scale로 읽기
- -1 : IMREAD_UNCHANGED : color(BGR) + alpha channel 까지 포함하여 읽기